<html>

<head>
    <meta charset="utf-8">
    <title>从一件小事来看软件项目预计工期与实际情况的巨大差别 - Lv Xiaoyu `Site</title>
    <link rel="stylesheet" href="../../static/css/bootstrap.min.css?v=1" />
    <link rel="stylesheet" href="../../static/css/mp.css?v=1" />
    <link rel="stylesheet" href="../../static/css/codehilite.css?v=1" />
</head>

<body>
    <div class="container">
        <div class="blog-header">
            <a href="../../index.html">
                <h1>Lv Xiaoyu `Site</h1>
            </a>
        </div>

        <div class="col-sm-9">
            <h3 class="blog-post-title">从一件小事来看软件项目预计工期与实际情况的巨大差别</h3>

            <div class="post-content">
                <p>昨天帮我表哥做了一件小事：他一个朋友有一个网站（<a href="http://www.szzg.org.cn/index.html">时政中国</a>），运营的不是很好 ，现在交给我表哥帮忙打理。我表哥认为这个网站需要增加一些栏目，增加至少再多加一行，让我帮忙。</p>
<p>我想这个应该不难，登陆网站后台看了一下，原来这个网站是基于<a href="http://www.dedecms.com/">织梦CMS</a>的，但是首页上方标题栏默认显示的栏目数量是固定的，在后台的配置里并没有定制栏目数量和行数的选项。
还好这个系统是开源的，于是下载了它的系统，在本地搭建了XAMPP环境，修改了一些代码研究了一下，找到了增加显示的栏目数量、以及分两行显示的方法。需要修改这个系统里的两三个文件里的几处地方。</p>
<p>由于这个<a href="http://www.szzg.org.cn/index.html">时政中国</a>是线上系统，本身是有一定用户的，白天修改可能会对用户浏览造成一定影响，于是我与表哥商量，晚上九点开始修改。</p>
<p>诸位请注意，情况是，我已经找到了解决办法，具体到修改哪个文件的哪一行，并且已经在本地做了实验。就差进行线上实施了。这样的情况下，我想顶多二十分钟也能搞定了吧？</p>
<p>结果我从晚上八点多开始搞，接近凌晨十二点才算弄完。</p>
<p>具体来说，有如下原因：</p>
<p>一、我在后台修改了CSS文件之后，浏览前台页面发现，标题栏的文字总是对不齐。清空了本地的浏览器缓存，Chrome、Firefox、IE三种浏览器轮番清空、刷新、F5、Ctrl+F5...，页面就是不按照我改的样子出现。查看CSS文件发现，它是我改动之前的版本。</p>
<p>于是我怀疑这个织梦CMS系统对静态文件有某种缓存，甚至干脆对文件有保护和还原的机制。然后我就翻遍了后台管理的每一个配置项，试图找出问题出在哪里。后台我拿iPad打开网页，发现iPad上呈现的网页却已经是预期的效果了。然后我觉得还是我本机的问题，又拿MacBook打开，却又是对不齐的样子了。</p>
<p>后来终于发现，这个问题分为两个部分：</p>
<ol>
<li>CSS文件迟迟不更新成新的版本。</li>
<li>IE浏览器对CSS的属性line-height支持是有问题的，我在css文件中对line-height属性所做的修改根本就不起作用。详见<a href="https://www.google.com/search?q=ie+line+height+problem&amp;oq=ie+line+height+problem&amp;aqs=chrome..69i57.895j0j9&amp;sourceid=chrome&amp;es_sm=122&amp;ie=UTF-8">谷歌搜索：ie line height problem</a>。</li>
</ol>
<p>这两个问题虽然都不大，但是相互纠缠起来就会令人百思不得其解了。</p>
<ol>
<li>css文件不更新，修改line-height属性根本起不到作用。</li>
<li>即便各种重启、清空缓存，css文件更新了，IE视line-height属性的改动为无物，给人感觉还是没起作用。</li>
</ol>
<p>最后，你也不知道到底是因为CSS文件没有更新，还是别的什么原因。即便你碰巧找出了其中一个原因，解决一下没有看到效果，你会觉得不是这个原因，从而与解决办法擦身而过。</p>
<p>二、织梦CMS系统基于PHP开发，但它默认呈现的不是PHP的动态页面，而是在任何内容发布时，生成一个静态HTML页面。用户打开的所有页面，其实都是CMS系统已经生成好的静态页面。这种机制是很常见的一种优化性能的手段，不能说有什么不好。</p>
<p>问题在于，我之前根本就没有意识到这个问题。在本地系统上所做的修改和测试，只是简单的看了一下首页效果，发现标题栏的栏目已经按预期的变成了两栏之后，我就认为自己的工作已经完成了。然后，表哥告诉我，在首页和每个栏目的主页面看，标题栏的确是两栏，点击查看某篇文章之后，标题栏又回到了之前一栏的状态。</p>
<p>在简单的分析之后，我发现了这里的问题，还好，织梦的后台系统提供了一键更新网站的功能。但是点击运行了一下就卡死了。这很正常。PHP的运行效率本来就不算太高，这个网站共有十几个栏目、四千多篇文章，全部生成至少意味着如下三个步骤：</p>
<ol>
<li>从数据库里取出数据</li>
<li>准备好所有的参数配置，调用模板引擎渲染生成HTML</li>
<li>将生成的这许多文件保存在相应目录</li>
</ol>
<p>试了几次“一键更新”之后，发现经常卡死。还好后台也提供了分别更新的功能。分别是更新主页、更新栏目、更新文档，其中更新文档最为耗时。一次更新所有文档也会卡死，需要按栏目分别更新。然后我就一次一次的操作，搞了一个多小时。</p>
<p>感受：</p>
<ol>
<li>
<p>在软件和IT领域的任何项目，对时间的预估都有可能太乐观了。有情况没有考虑到的话，花两倍的时间是很正常的，如果不是二十倍的话。这方面有人讨论过了，详见<a href="http://www.csdn.net/article/2012-08-07/2808266">为什么程序员不擅长估算时间？</a>。</p>
</li>
<li>
<p>计算机、操作系统、网络、软件，这些本来就是很复杂的。这些跟技术有关的任何东西，你都要做好出问题的心里准备。甚至，出现问题是正常的，不出现问题是不正常的。如果你不喜欢麻烦，不喜欢从各方面研究解决问题，估计搞技术工作不适合你。</p>
</li>
</ol>
<p>说明：</p>
<p>我记录这次经历，绝不是说织梦CMS不好。相反，我认为它是在国产CMS系统里比较靠谱的一个。如果熟悉它的机制，使用得当的话，承载各种类型的中小网站是可以的。更好的一点是它是开源的。我看许多PHP开发者说在学习PHP时选择了织梦CMS作为学习和研究对象。</p>
            </div>
        </div>
        <div class="col-md-3" role="complementary">
            <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix">
                
                <ul class="nav bs-docs-sidenav">
                    
                </ul>              
            </nav>
        </div>
    </div>
</body>

</html>